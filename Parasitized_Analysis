##### Parasitized Analysis - SERC Striped Bass Dissection Data#####
#Author: Hannah C Brunelle
#Advisor: Dr.Katrina Lohan
#Date: June 14,2022 - 

#Mean and SD of Condition Factors
YesmeanK <- mean(Parasitized_yes$K, na.rm = TRUE) #1.190
YesSDK <- sd(Parasitized_yes$K, na.rm = TRUE) #0.130

install.packages("arsenal")
library(arsenal)
Comparedf(Parasitized_no, Parasitized_yes)

#Sub-setting by a specific value within a variable
#Parasites found 
#K (mean 1.190) (min 0.652)(max 1.702)
Parasitized_yes <- subset(DissectionsK, Parasitized == "Yes")
View(Parasitized_yes)
summary(Parasitized_yes)

#####Shapiro Normality Test#####
#Add value to the histogram of the distribution
#The null-hypothesis of this test is that the population is normally distributed. 
#A data set with a p value of less than .05 rejects the null hypothesis that the data are from a normally distributed population
shapiro.test(Parasitized_yes$FL_cm) 
shapiro.test(Parasitized_yes$TL_cm) 
shapiro.test(Parasitized_yes$BodyWWt_g) 
shapiro.test(Parasitized_yes$K) #W = 0.94656, p-value = 0.0003226

#Histograms
hist(Parasitized_yes$FL_cm) #NOT NORMAL
hist(Parasitized_yes$TL_cm) #NOT NORMAL
hist(Parasitized_yes$BodyWWt_g) #NOT NORMAL
hist(Parasitized_yes$K) #Show Katrina

#Parasites per Tributary
boxplot(Parasitized_yes$K ~ Parasitized_no$K)

ggplot(DissectionsK) +
  aes(x = Tributary_Main, y = Acanthocephalan, colour = Tributary_Main) +
  geom_boxplot()

#####Task #1#####
#PLaying around with the scatterplots 
#How to put titles into plots
plot(Parasitized_yes$Acanthocephalan,Parasitized_yes$K, 
     main='Condition Factor compared to Acanthocephlan Abundance',
     xlab='Condition Factor (K)',ylab='Acanthocephlan Abundance')

# plot a regression line
abline(lm(Acanthocephalan~K,data=Parasitized_yes),col='red')

plot(Parasitized_yes$K , Parasitized_yes$Acanthocephalan)
abline(PlotResults)
PlotResults <- lm(Acanthocephalan ~ K, data = Parasitized_yes)
summary(PlotResults)

lmod= lm(Acanthocephalan~K, Parasitized_yes)
summary(lmod)

#Different way to make a scatterplot with a regression
#Regular Scatterplot with Regression and Labels
library(ggplot2)
ggplot(Parasitized_yes, aes(K, Acanthocephalan, shape = Age_Class)) +
  geom_point()+
  geom_smooth(method=lm, se=0)+
  theme_classic()+
  annotate("text", x=1.5, y=45, label="p-value: 0.992")+
  annotate("text", x=1.5, y=42, label="Multiple R-squared:  0.007574")+
  annotate("text", x=1.5, y=39, label="Acanthocephalan = 4.481*K + 0.0635")

#Scatterplot with labels, regression and shapes/colors per point
#Extended regression line and removed confidence intervals
ggplot(Parasitized_yes, aes(x=K, y=Acanthocephalan, color=Age_Class, shape=Age_Class)) +
  geom_point() + 
  geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
  theme_classic()+
  annotate("text", x=1.2, y=45, label="p-value: 0.992")+
  annotate("text", x=1.2, y=42, label="Multiple R-squared:  0.007574")+
  annotate("text", x=1.2, y=39, label="Acanthocephalan = 4.481*K + 0.0635")

ggplot(Parasitized_yes, aes(x = K, y = Acanthocephalan, shape = Age_Class)) +
  geom_point(size = 3) 


#Parasites per K - Scatterplot - No Regression
library(tidyverse)
plot(x = Parasitized_yes$K, y = Parasitized_yes$Acanthocephalan)

Parasitized_yes %>% ggplot(aes(x = K, y = Acanthocephalan)) +
  geom_point(aes(color = Age_Class))
abline(lm(Acanthocephalan~K,data=Parasitized_yes),col='red')

######Task 2######
#Boxplot showing Acantho. Abundance per Tributary 
boxplot(Parasitized_yes$Acanthocephalan ~ Parasitized_yes$Tributary)

ggplot(Parasitized_yes) +
  aes(x = Acanthocephalan, y = Tributary, colour = Tributary) +
  geom_boxplot()

#Boxplot showing Acantho. Abundance per Age Class
boxplot(Parasitized_yes$Acanthocephalan ~ Parasitized_yes$Age_Class)

ggplot(Parasitized_yes) +
  aes(x = Acanthocephalan, y = Age_Class, colour = Age_Class) +
  geom_boxplot()

#Statistical Tests between Acant. Abundance and K in Parasitized Fish only
kruskal.test(Parasitized_yes$Acanthocephalan, Parasitized_yes$K)
#p-value = 0.461
