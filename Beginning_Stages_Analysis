#####Beginning Stages of Playing with SERC Striped Bass Dissection Data#####
#Author: Hannah C Brunelle
#Advisor: Dr.Katrina Lohan
#Date: June 14,2022 - 

#Import data
dissections <-read.csv("StripedBassDietDissections_2022.csv", header=TRUE)

SERCacanth <- acanthocephalan_data1[-c(1811:nrow(acanthocephalan_data1)), ]
#Investigating Data
str(SERCacanth)
head(SERCacanth)

#Preview the Data 
View(SERCacanth)

#Loading in Packages 
library(tidyverse)
library(lubridate)
library(dplyr)
library(ggpubr)

#Selecting Columns 
select(dissections, FL_mm, TL_mm, Age_Class, BodyWWt_g, Acanthocephalan, Tributary)

#####Selecting only the data for Acanthocephalans#####
#Looking at fork and tail length, age, body weight, and total count of the worms
SERCacanth <- select(dissections, FL_mm, TL_mm, Age_Class, BodyWWt_g, Acanthocephalan, Tributary, Season)
view(SERCacanth)

#Creating a class of parasitized striped bass (yes/no)
library(tibble)
SERCacanth <- acanthocephalan_data %>%
  add_column(Parasitized = 
               if_else(SERCacanth$Acanthocephalan > 0, "Yes", "No"),
             .after="Acanthocephalan")
table(SERCacanth$Parasitized) #Checking out the new class
table(acanthocephalan_data$Acanthocephalan) #making sure all was still all right

#Creating a class of combined Tributaries 
library(tibble)
SERCANTH1 <- SERCANTH1 %>%
  mutate(Tributary = case_when(                                #"Class" will be the new column, and "case_when" will give the conditions to populate the column
    endsWith(Tributary, "York_Pamunkey") ~ "York",    #"endsWith: guides where the info is and what value to look for; 
    endsWith(Tributary, "York_Mattaponi") ~ "York", #in this case is looking into "Classification" column and for the value "Cucculanid"
    endsWith(Tributary, "York_Lower") ~ "York",   #the "~Chromadorea" indicates the new value on the new column based on the value in "Classificatio"
    endsWith(Tributary, "Upper_Bay") ~ "Upper_Bay",
    endsWith(Tributary, "Rhode") ~ "Rhode",
    endsWith(Tributary, "Rappahannock_Upper") ~ "Rappahannock",
    endsWith(Tributary, "Rappahannock_Lower") ~ "Rappahannock",
    endsWith(Tributary, "Potomac") ~ "Potomac",
    endsWith(Tributary, "Patuxent") ~ "Patuxent",
    endsWith(Tributary, "Nanticoke") ~ "Nanticoke",
    endsWith(Tributary, "James_Upper") ~ "James",
    endsWith(Tributary, "James_Lower") ~ "James",
    endsWith(Tributary, "Choptank") ~ "Choptank"
  ))

table(SERCacanth$TributaryLocation) #Checking out the new class
table(SERCacanth$Tributary) #making sure all was still all right

#Creating a class of combined Month and Seasons 
library(tibble)
SERCANTH1 <- SERCANTH1 %>%
  mutate(Season = case_when(                                #"Class" will be the new column, and "case_when" will give the conditions to populate the column
    endsWith(Season, "Spring") ~ "Spring",    #"endsWith: guides where the info is and what value to look for; 
    endsWith(Season, "September") ~ "Fall", #in this case is looking into "Classification" column and for the value "Cucculanid"
    endsWith(Season, "Fall") ~ "Fall",
    endsWith(Season, "Late_Summer") ~ "Late_Summer",
    endsWith(Season, "LateSummer") ~ "Late_Summer",
    endsWith(Season, "August") ~ "Late_Summer",
    endsWith(Season, "July") ~ "Mid_Summer",
    endsWith(Season, "Early_Summer") ~ "Early_Summer"
  ))
table(SERCacanth$Season) #Checking out the new class
table(SERCacanth$Tributary) #making sure all was still all right

#Trying to add vectors to Acanthocephlan counts 
#Trying to create intervals 
x = seq(from = 1,
        to = 100,
        by = 10) #this means (starting number, ending number, interval)
  

######Converting a variable into numeric if for some bizarre reason the data did not read as numerical:######
#A summary of the information within the data set
summary(acanthocephalan_data) 
#for some reason some of the numerical variables are showing as character
#Converting to numeric
SERCacanth$FL_mm <- as.numeric(as.character(SERCacanth$FL_mm)) 
SERCacanth$TL_mm <- as.numeric(as.character(SERCacanth$TL_mm))
SERCacanth$Acanthocephalan <- as.numeric(as.character(SERCacanth$Acanthocephalan))
SERCacanth$Age_Class <- as.numeric(as.character(SERCacanth$Age_Class))
#Check if it worked with:
summary(acanthocephalan_data1)
summary(SERCacanth)

#Removing NA
#For some reason R is adding in LOTs of extra rows 
SERCANTH1 <- SERCANTH1[-c(1811:nrow(SERCANTH1)), ]
SERCANTH1
