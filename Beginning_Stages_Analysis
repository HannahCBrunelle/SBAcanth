#####Beginning Stages of Playing with SERC Striped Bass Dissection Data#####
#Author: Hannah C Brunelle
#Advisor: Dr.Katrina Lohan
#Date: June 14,2022 - 

#Import data
library(readxl)
DissectionsK <- read_excel("~/Desktop/DissectionsK.xls")
View(DissectionsK)

#Removing NA
#For some reason R is adding in LOTs of extra rows 
DissectionsK <- DissectionsK[-c(575:nrow(DissectionsK)), ]
DissectionsK

#Investigating Data
str(DissectionsK)
head(DissectionsK)

#Preview the Data 
View(DissectionsK)

#Loading in Packages 
library(tidyverse)
library(lubridate)
library(dplyr)
library(ggpubr)

#####Selecting only the data for Acanthocephalans#####
#Looking at fork and tail length, age, body weight, and total count of the worms
SERCacanth <- select( FL_mm, TL_mm, Age_Class, BodyWWt_g, Acanthocephalan, Tributary, Season)
view(SERCacanth)

#Creating a class of parasitized striped bass (yes/no)
library(tibble)
DissectionsK <- DissectionsK%>%
  add_column(Parasitized = 
               if_else(DissectionsK$Acanthocephalan > 0, "Yes", "No"),
             .after="Acanthocephalan")

table(DissectionsK$Parasitized) #Checking out the new class
table(DissectionsK$Acanthocephalan) #making sure all was still all right

#Creating a class of combined Tributaries 
library(tibble)
DissectionsK <- DissectionsK %>%
  mutate(Tributary = case_when(                                #"Class" will be the new column, and "case_when" will give the conditions to populate the column
    endsWith(Tributary, "York_Pamunkey") ~ "York",    #"endsWith: guides where the info is and what value to look for; 
    endsWith(Tributary, "York_Mattaponi") ~ "York", #in this case is looking into "Classification" column and for the value "Cucculanid"
    endsWith(Tributary, "York_Lower") ~ "York",   #the "~Chromadorea" indicates the new value on the new column based on the value in "Classificatio"
    endsWith(Tributary, "Upper_Bay") ~ "Upper_Bay",
    endsWith(Tributary, "Rhode") ~ "Rhode",
    endsWith(Tributary, "Rappahannock_Upper") ~ "Rappahannock",
    endsWith(Tributary, "Rappahannock_Lower") ~ "Rappahannock",
    endsWith(Tributary, "Potomac") ~ "Potomac",
    endsWith(Tributary, "Patuxent") ~ "Patuxent",
    endsWith(Tributary, "Nanticoke") ~ "Nanticoke",
    endsWith(Tributary, "James_Upper") ~ "James",
    endsWith(Tributary, "James_Lower") ~ "James",
    endsWith(Tributary, "Choptank") ~ "Choptank"
  ))

table(DissectionsK$TributaryLocation) #Checking out the new class
table(DissectionsK$Tributary) #making sure all was still all right

#Creating a class of combined Month and Seasons 
library(tibble)
DissectionsK <- DissectionsK %>%
  mutate(Season = case_when(                                #"Class" will be the new column, and "case_when" will give the conditions to populate the column
    endsWith(Season, "Spring") ~ "Spring",    #"endsWith: guides where the info is and what value to look for; 
    endsWith(Season, "September") ~ "Fall", #in this case is looking into "Classification" column and for the value "Cucculanid"
    endsWith(Season, "Fall") ~ "Fall",
    endsWith(Season, "Late_Summer") ~ "Late_Summer",
    endsWith(Season, "LateSummer") ~ "Late_Summer",
    endsWith(Season, "August") ~ "Late_Summer",
    endsWith(Season, "July") ~ "Mid_Summer",
    endsWith(Season, "Early_Summer") ~ "Early_Summer"
  ))
table(DissectionsK$Season) #Checking out the new class
table(DissectionsK$Tributary) #making sure all was still all right


######Converting a variable into numeric if for some bizarre reason the data did not read as numerical:######
#A summary of the information within the data set
summary(DissectionsK) 
#for some reason some of the numerical variables are showing as character
#Converting to numeric
DissectionsK$FL_mm <- as.numeric(as.character(DissectionsK$FL_mm)) 
DissectionsK$Acanthocephalan <- as.numeric(as.character(DissectionsK$Acanthocephalan))
DissectionsK$K <- as.numeric(as.character(DissectionsK$K))
DissectionsK$BodyWWt_g <- as.numeric(as.character(DissectionsK$BodyWWt_g))
DissectionsK$TL_mm <- as.numeric(as.character(DissectionsK$TL_mm))
DissectionsK$TL_cm <- as.numeric(as.character(DissectionsK$TL_cm))
DissectionsK$FL_cm <- as.numeric(as.character(DissectionsK$FL_mm))

#Check if it worked with:
DissectionsK 
